app.register.controller("activityBeautyLifeController",function($rootScope,$scope,httpRequest,dataStringify,signSha1,analytics,$location){$scope.isShowNavbar=!1,$scope.isApp=isApp($location),$scope.isShowNavbar=$scope.isApp?!1:!0;var link="http://goeasy.yhiker.com/#/activity/beautyLife?source=3&sharedTo=",imgUrl="http://goeasy.yhiker.com/image/activity/beautyLife/1.jpg",title="购轻松台湾",desc="美丽人生",createNonceStr=function(){return Math.random().toString(36).substr(2,15)},createTimestamp=function(){return parseInt((new Date).getTime()/1e3)+""},raw=function(args){var keys=Object.keys(args);keys=keys.sort();var newArgs={};keys.forEach(function(key){newArgs[key.toLowerCase()]=args[key]});var string="";for(var k in newArgs)string+="&"+k+"="+newArgs[k];return string=string.substr(1)},nonceStr=createNonceStr(),timestamp=createTimestamp(),weixinSdkConfig=function(){$scope.ticket=getWxSdkToken().ticket;var ret={jsapi_ticket:getWxSdkToken().ticket,nonceStr:nonceStr,timestamp:timestamp,url:$location.absUrl().split("#")[0]},string=raw(ret),signature=signSha1(string),config={appId:easybuy.weixinAppId,timestamp:timestamp,nonceStr:nonceStr,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"],signature:signature};$(document).ready(function(){wx.config(config),wx.ready(function(){wx.onMenuShareTimeline({title:desc,link:link+"1",imgUrl:imgUrl,success:function(){$scope.fadeOutShare();{var tokenInfo=getToken();"platform=all&token="+tokenInfo.token}},cancel:function(){}}),wx.onMenuShareAppMessage({title:title,desc:desc,link:link+"2",imgUrl:imgUrl,type:"link",dataUrl:"",success:function(){},cancel:function(){}})}),wx.error(function(res){alertWarning(JSON.stringify(res))})})};if(easybuy.isWechat)if(!getWxSdkToken()||getWxSdkToken()&&!getWxSdkToken().ticket){var data="platform=all";httpRequest.APIPOST("/wx/data?platform=all",null,{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){var data=result.result;setWxSdkToken({accessToken:data.access_token,ticket:data.ticket}),weixinSdkConfig()}else alert(result.msg)})}else weixinSdkConfig();if($scope.goTo=function(index){for(var g=[],i=0;i<$scope.products.length;i++)g.push($scope.products[i].goodsId);index<=g.length&&($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+g[index-1]:$location.path("/product/"+g[index-1]+"/1"))},$scope.goProduct=function(id){return id?void($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+id:$location.path("/product/"+id+"/1")):void alertWarning("该商品已经下架，请选择其他商品购买^_^")},$scope.buyNow=function(path,action){$scope.isApp?window.location.href=easybuy.appActivity+"?action="+action:$location.path("/"+path)},$scope.more=function(){$scope.isApp?window.location.href=easybuy.appActivity+"?action=5":$location.path("/products")},$scope.shareToFriends=function(){if($scope.isApp)return void(window.location.href=easybuy.appActivity+"?action=3&shareTitle="+title+"&shareText="+desc+"&shareUrl="+link+"&shareImageUrl="+imgUrl);if(easybuy.isWechat){var tokenInfo=getToken();tokenInfo&&tokenInfo.token&&tokenInfo.openId?$scope.fadeInShare():$location.path("/wechatOauth/activity-activityDetail")}else{var arrButton=["确定"];openDialog("请在微信内打开并分享到朋友圈","",arrButton,null,function(r){})}},$scope.shareSuccess=function(){},$scope.back=function(){$location.path("/products")},$scope.fadeOutShare=function(){$("#shareHint").fadeOut()},$scope.fadeInShare=function(){$("#shareHint").fadeIn()},$location.search()){var actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId;var data="platform=all&activityId="+actId;httpRequest.APIPOST("/activity/detail",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){if($scope.activityInfo=result.result,null==result.result)return void alertExt("该活动已结束，更多精彩活动尽在首页！",function(){$location.path("/"),$scope.$apply($location)});var act=$scope.activityInfo.activity;act.url||(act.url=""),link=act.url.indexOf("?")>0?act.url+"&activityId="+act.id+"&source=3&sharedTo=":act.url+"?activityId="+act.id+"&source=3&sharedTo=",imgUrl=act.img,title=act.name,desc=act.desc,$scope.products=[],$scope.activityInfo&&$scope.activityInfo.fullGiveGoodsList&&($scope.products=$scope.activityInfo.fullGiveGoodsList)}else alert(result.msg+":ctivity-detail")})}if($location.search()&&$location.search().sharedTo&&$location.search().source){var actId=($location.search(),""),channel=$location.search().sharedTo||1;channel instanceof Array&&(channel=1);{var platform=$location.search().source||"all";$location.search().pageType||""}platform=1==platform?"android":2==platform?"ios":"all",actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId;var token="";getToken()&&(token="&token="+getToken().token);var data="activityId="+actId+"&channel="+channel+"&platform="+platform+token;httpRequest.APIPOST("/activity/clickLog",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success})}else{var platform=$location.search().platform||"all",token=$location.search().token||"",actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId,token?token="&token="+token:getToken()&&(token="&token="+getToken().token);var data="activityId="+actId+"&type=2&platform="+platform+token;httpRequest.APIPOST("/activity/clickLog",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success})}}),app.register.controller("activityTangcunController",function($rootScope,$scope,httpRequest,dataStringify,signSha1,analytics,$location){$scope.isShowNavbar=!1,$scope.isApp=isApp($location),$scope.isShowNavbar=$scope.isApp?!1:!0;var link="http://goeasy.yhiker.com/#/activity/tangcun?source=3&sharedTo=",imgUrl="http://goeasy.yhiker.com/image/activity/tangcun/1.jpg",title="购轻松台湾",desc="塘村伴手礼",createNonceStr=function(){return Math.random().toString(36).substr(2,15)},createTimestamp=function(){return parseInt((new Date).getTime()/1e3)+""},raw=function(args){var keys=Object.keys(args);keys=keys.sort();var newArgs={};keys.forEach(function(key){newArgs[key.toLowerCase()]=args[key]});var string="";for(var k in newArgs)string+="&"+k+"="+newArgs[k];return string=string.substr(1)},nonceStr=createNonceStr(),timestamp=createTimestamp(),weixinSdkConfig=function(){$scope.ticket=getWxSdkToken().ticket;var ret={jsapi_ticket:getWxSdkToken().ticket,nonceStr:nonceStr,timestamp:timestamp,url:$location.absUrl().split("#")[0]},string=raw(ret),signature=signSha1(string),config={appId:easybuy.weixinAppId,timestamp:timestamp,nonceStr:nonceStr,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"],signature:signature};$(document).ready(function(){wx.config(config),wx.ready(function(){wx.onMenuShareTimeline({title:desc,link:link+"1",imgUrl:imgUrl,success:function(){$scope.fadeOutShare();{var tokenInfo=getToken();"platform=all&token="+tokenInfo.token}},cancel:function(){}}),wx.onMenuShareAppMessage({title:title,desc:desc,link:link+"2",imgUrl:imgUrl,type:"link",dataUrl:"",success:function(){},cancel:function(){}})}),wx.error(function(res){alertWarning(JSON.stringify(res))})})};if(easybuy.isWechat)if(!getWxSdkToken()||getWxSdkToken()&&!getWxSdkToken().ticket){var data="platform=all";httpRequest.APIPOST("/wx/data?platform=all",null,{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){var data=result.result;setWxSdkToken({accessToken:data.access_token,ticket:data.ticket}),weixinSdkConfig()}else alert(result.msg)})}else weixinSdkConfig();if($scope.goTo=function(index){for(var g=[],i=0;i<$scope.products.length;i++)g.push($scope.products[i].goodsId);index<=g.length&&($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+g[index-1]:$location.path("/product/"+g[index-1]+"/1"))},$scope.goProduct=function(id){return id?void($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+id:$location.path("/product/"+id+"/1")):void alertWarning("该商品已经下架，请选择其他商品购买^_^")},$scope.buyNow=function(path,action){$scope.isApp?window.location.href=easybuy.appActivity+"?action="+action:$location.path("/"+path)},$scope.more=function(){$scope.isApp?window.location.href=easybuy.appActivity+"?action=5":$location.path("/products")},$scope.shareToFriends=function(){if($scope.isApp)return void(window.location.href=easybuy.appActivity+"?action=3&shareTitle="+title+"&shareText="+desc+"&shareUrl="+link+"&shareImageUrl="+imgUrl);if(easybuy.isWechat){var tokenInfo=getToken();tokenInfo&&tokenInfo.token&&tokenInfo.openId?$scope.fadeInShare():$location.path("/wechatOauth/activity-activityDetail")}else{var arrButton=["确定"];openDialog("请在微信内打开并分享到朋友圈","",arrButton,null,function(r){})}},$scope.shareSuccess=function(){},$scope.back=function(){$location.path("/products")},$scope.fadeOutShare=function(){$("#shareHint").fadeOut()},$scope.fadeInShare=function(){$("#shareHint").fadeIn()},$location.search()){var actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId;var data="platform=all&activityId="+actId;httpRequest.APIPOST("/activity/detail",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){if($scope.activityInfo=result.result,null==result.result)return void alertExt("该活动已结束，更多精彩活动尽在首页！",function(){$location.path("/"),$scope.$apply($location)});var act=$scope.activityInfo.activity;act.url||(act.url=""),link=act.url.indexOf("?")>0?act.url+"&activityId="+act.id+"&source=3&sharedTo=":act.url+"?activityId="+act.id+"&source=3&sharedTo=",imgUrl=act.img,title=act.name,desc=act.desc,$scope.products=[],$scope.activityInfo&&$scope.activityInfo.fullGiveGoodsList&&($scope.products=$scope.activityInfo.fullGiveGoodsList)}else alert(result.msg+":ctivity-detail")})}if($location.search()&&$location.search().sharedTo&&$location.search().source){var actId=($location.search(),""),channel=$location.search().sharedTo||1;channel instanceof Array&&(channel=1);{var platform=$location.search().source||"all";$location.search().pageType||""}platform=1==platform?"android":2==platform?"ios":"all",actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId;var token="";getToken()&&(token="&token="+getToken().token);var data="activityId="+actId+"&channel="+channel+"&platform="+platform+token;httpRequest.APIPOST("/activity/clickLog",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success})}else{var platform=$location.search().platform||"all",token=$location.search().token||"",actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId,token?token="&token="+token:getToken()&&(token="&token="+getToken().token);var data="activityId="+actId+"&type=2&platform="+platform+token;httpRequest.APIPOST("/activity/clickLog",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success})}}),app.register.controller("activityTourController",function($rootScope,$scope,httpRequest,dataStringify,signSha1,analytics,$location){$scope.isShowNavbar=!1,$scope.isApp=isApp($location),$scope.isShowNavbar=$scope.isApp?!1:!0;var link="http://goeasy.yhiker.com/#/activity/tour?source=3&sharedTo=",imgUrl="http://goeasy.yhiker.com/image/activity/tour/1.jpg",title="购轻松台湾",desc="轻松畅游台北101",createNonceStr=function(){return Math.random().toString(36).substr(2,15)},createTimestamp=function(){return parseInt((new Date).getTime()/1e3)+""},raw=function(args){var keys=Object.keys(args);keys=keys.sort();var newArgs={};keys.forEach(function(key){newArgs[key.toLowerCase()]=args[key]});var string="";for(var k in newArgs)string+="&"+k+"="+newArgs[k];return string=string.substr(1)},nonceStr=createNonceStr(),timestamp=createTimestamp(),weixinSdkConfig=function(){$scope.ticket=getWxSdkToken().ticket;var ret={jsapi_ticket:getWxSdkToken().ticket,nonceStr:nonceStr,timestamp:timestamp,url:$location.absUrl().split("#")[0]},string=raw(ret),signature=signSha1(string),config={appId:easybuy.weixinAppId,timestamp:timestamp,nonceStr:nonceStr,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"],signature:signature};$(document).ready(function(){wx.config(config),wx.ready(function(){wx.onMenuShareTimeline({title:desc,link:link+"1",imgUrl:imgUrl,success:function(){$scope.fadeOutShare();{var tokenInfo=getToken();"platform=all&token="+tokenInfo.token}},cancel:function(){}}),wx.onMenuShareAppMessage({title:title,desc:desc,link:link+"2",imgUrl:imgUrl,type:"link",dataUrl:"",success:function(){},cancel:function(){}})}),wx.error(function(res){alertWarning(JSON.stringify(res))})})};if(easybuy.isWechat)if(!getWxSdkToken()||getWxSdkToken()&&!getWxSdkToken().ticket){var data="platform=all";httpRequest.APIPOST("/wx/data?platform=all",null,{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){var data=result.result;setWxSdkToken({accessToken:data.access_token,ticket:data.ticket}),weixinSdkConfig()}else alert(result.msg)})}else weixinSdkConfig();if($scope.goTo=function(index){for(var g=[],i=0;i<$scope.products.length;i++)g.push($scope.products[i].goodsId);index<=g.length&&($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+g[index-1]:$location.path("/product/"+g[index-1]+"/1"))},$scope.goProduct=function(id){return id?void($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+id:$location.path("/product/"+id+"/1")):void alertWarning("该商品已经下架，请选择其他商品购买^_^")},$scope.buyNow=function(path,action){$scope.isApp?window.location.href=easybuy.appActivity+"?action="+action:$location.path("/"+path)},$scope.more=function(){$scope.isApp?window.location.href=easybuy.appActivity+"?action=5":$location.path("/products")},$scope.shareToFriends=function(){if($scope.isApp)return void(window.location.href=easybuy.appActivity+"?action=3&shareTitle="+title+"&shareText="+desc+"&shareUrl="+link+"&shareImageUrl="+imgUrl);if(easybuy.isWechat){var tokenInfo=getToken();tokenInfo&&tokenInfo.token&&tokenInfo.openId?$scope.fadeInShare():$location.path("/wechatOauth/activity-activityDetail")}else{var arrButton=["确定"];openDialog("请在微信内打开并分享到朋友圈","",arrButton,null,function(r){})}},$scope.shareSuccess=function(){},$scope.back=function(){$location.path("/products")},$scope.fadeOutShare=function(){$("#shareHint").fadeOut()},$scope.fadeInShare=function(){$("#shareHint").fadeIn()},$location.search()){var actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId||0;var data="platform=all&activityId="+actId;httpRequest.APIPOST("/activity/detail",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){if($scope.activityInfo=result.result,null==result.result)return void alertExt("该活动已结束，更多精彩活动尽在首页！",function(){$location.path("/"),$scope.$apply($location)});var act=$scope.activityInfo.activity;act.url||(act.url=""),link=act.url.indexOf("?")>0?act.url+"&activityId="+act.id+"&source=3&sharedTo=":act.url+"?activityId="+act.id+"&source=3&sharedTo=",imgUrl=act.img,title=act.name,desc=act.desc,$scope.products=[],$scope.activityInfo&&$scope.activityInfo.downPriceGoodsList&&($scope.products=$scope.activityInfo.downPriceGoodsList)}else alert(result.msg+":ctivity-detail")})}if($location.search()&&$location.search().sharedTo&&$location.search().source){var actId=($location.search(),""),channel=$location.search().sharedTo||1;channel instanceof Array&&(channel=1);{var platform=$location.search().source||"all";$location.search().pageType||""}platform=1==platform?"android":2==platform?"ios":"all",actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId;var token="";getToken()&&(token="&token="+getToken().token);var data="activityId="+actId+"&channel="+channel+"&platform="+platform+token;httpRequest.APIPOST("/activity/clickLog",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success})}else{var platform=$location.search().platform||"all",token=$location.search().token||"",actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId,token?token="&token="+token:getToken()&&(token="&token="+getToken().token);var data="activityId="+actId+"&type=2&platform="+platform+token;httpRequest.APIPOST("/activity/clickLog",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success})}}),app.register.controller("activityGroupBuyController",function($rootScope,$scope,httpRequest,dataStringify,signSha1,analytics,$location){$scope.isShowNavbar=!1,$scope.isApp=isApp($location),$scope.isShowNavbar=$scope.isApp?!1:!0;var link="http://goeasy.yhiker.com/#/activity/groupBuy?source=3&sharedTo=",imgUrl="http://goeasy.yhiker.com/image/activity/groupBuy/1.jpg",title="购轻松台湾",desc="姐姐妹妹来拼团",createNonceStr=function(){return Math.random().toString(36).substr(2,15)},createTimestamp=function(){return parseInt((new Date).getTime()/1e3)+""},raw=function(args){var keys=Object.keys(args);keys=keys.sort();var newArgs={};keys.forEach(function(key){newArgs[key.toLowerCase()]=args[key]});var string="";for(var k in newArgs)string+="&"+k+"="+newArgs[k];return string=string.substr(1)},nonceStr=createNonceStr(),timestamp=createTimestamp(),weixinSdkConfig=function(){$scope.ticket=getWxSdkToken().ticket;var ret={jsapi_ticket:getWxSdkToken().ticket,nonceStr:nonceStr,timestamp:timestamp,url:$location.absUrl().split("#")[0]},string=raw(ret),signature=signSha1(string),config={appId:easybuy.weixinAppId,timestamp:timestamp,nonceStr:nonceStr,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"],signature:signature};$(document).ready(function(){wx.config(config),wx.ready(function(){wx.onMenuShareTimeline({title:desc,link:link+"1",imgUrl:imgUrl,success:function(){$scope.fadeOutShare();{var tokenInfo=getToken();"platform=all&token="+tokenInfo.token}},cancel:function(){}}),wx.onMenuShareAppMessage({title:title,desc:desc,link:link+"2",imgUrl:imgUrl,type:"link",dataUrl:"",success:function(){},cancel:function(){}})}),wx.error(function(res){alertWarning(JSON.stringify(res))})})};if(easybuy.isWechat)if(!getWxSdkToken()||getWxSdkToken()&&!getWxSdkToken().ticket){var data="platform=all";httpRequest.APIPOST("/wx/data?platform=all",null,{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){var data=result.result;setWxSdkToken({accessToken:data.access_token,ticket:data.ticket}),weixinSdkConfig()}else alert(result.msg)})}else weixinSdkConfig();if($scope.goTo=function(index){for(var g=[],i=0;i<$scope.products.length;i++)g.push($scope.products[i].goodsId);index<=g.length&&($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+g[index-1]:$location.path("/product/"+g[index-1]+"/1"))},$scope.goProduct=function(id){return id?void($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+id:$location.path("/product/"+id+"/1")):void alertWarning("该商品已经下架，请选择其他商品购买^_^")},$scope.buyNow=function(path,action){$scope.isApp?window.location.href=easybuy.appActivity+"?action="+action:$location.path("/"+path)},$scope.more=function(){$scope.isApp?window.location.href=easybuy.appActivity+"?action=5":$location.path("/products")},$scope.shareToFriends=function(){if($scope.isApp)return void(window.location.href=easybuy.appActivity+"?action=3&shareTitle="+title+"&shareText="+desc+"&shareUrl="+link+"&shareImageUrl="+imgUrl);if(easybuy.isWechat){var tokenInfo=getToken();tokenInfo&&tokenInfo.token&&tokenInfo.openId?$scope.fadeInShare():$location.path("/wechatOauth/activity-activityDetail")}else{var arrButton=["确定"];openDialog("请在微信内打开并分享到朋友圈","",arrButton,null,function(r){})}},$scope.shareSuccess=function(){},$scope.back=function(){$location.path("/products")},$scope.fadeOutShare=function(){$("#shareHint").fadeOut()},$scope.fadeInShare=function(){$("#shareHint").fadeIn()},$location.search()){var actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId||20;var data="platform=all&activityId="+actId;httpRequest.APIPOST("/activity/detail",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){if($scope.activityInfo=result.result,null==result.result)return void alertExt("该活动已结束，更多精彩活动尽在首页！",function(){$location.path("/"),$scope.$apply($location)});var act=$scope.activityInfo.activity;act.url||(act.url=""),link=act.url.indexOf("?")>0?act.url+"&activityId="+act.id+"&source=3&sharedTo=":act.url+"?activityId="+act.id+"&source=3&sharedTo=",imgUrl=act.img,title=act.name,desc=act.desc,$scope.products=[],$scope.activityInfo&&$scope.activityInfo.restrictReduceGoodsList&&($scope.products=$scope.activityInfo.restrictReduceGoodsList)}else alert(result.msg+":ctivity-detail")})}if($location.search()&&$location.search().sharedTo&&$location.search().source){var actId=($location.search(),""),channel=$location.search().sharedTo||1;channel instanceof Array&&(channel=1);{var platform=$location.search().source||"all";$location.search().pageType||""}platform=1==platform?"android":2==platform?"ios":"all",actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId;var token="";getToken()&&(token="&token="+getToken().token);var data="activityId="+actId+"&channel="+channel+"&platform="+platform+token;httpRequest.APIPOST("/activity/clickLog",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success})}else{var platform=$location.search().platform||"all",token=$location.search().token||"",actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId,token?token="&token="+token:getToken()&&(token="&token="+getToken().token);var data="activityId="+actId+"&type=2&platform="+platform+token;httpRequest.APIPOST("/activity/clickLog",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success})}$scope.goBuy=function(){window.location.href=easybuy.appActivity+"?action=4&mustLogin=1&goodId=122&name=test&smallImg=test&promotePrice=10"}}),app.register.controller("activityXblnewController",function($rootScope,$scope,httpRequest,dataStringify,signSha1,analytics,$location){$scope.isShowNavbar=!1,$scope.isApp=isApp($location),$scope.isShowNavbar=$scope.isApp?!1:!0;var link="http://goeasy.yhiker.com/#/activity/beautySummer?source=3&sharedTo=",imgUrl="http://goeasy.yhiker.com/image/activity/beautySummer/banner.jpg",title="购轻松台湾",desc="小背篓",createNonceStr=function(){return Math.random().toString(36).substr(2,15)},createTimestamp=function(){return parseInt((new Date).getTime()/1e3)+""},raw=function(args){var keys=Object.keys(args);keys=keys.sort();var newArgs={};keys.forEach(function(key){newArgs[key.toLowerCase()]=args[key]});var string="";for(var k in newArgs)string+="&"+k+"="+newArgs[k];return string=string.substr(1)},nonceStr=createNonceStr(),timestamp=createTimestamp(),weixinSdkConfig=function(){$scope.ticket=getWxSdkToken().ticket;var ret={jsapi_ticket:getWxSdkToken().ticket,nonceStr:nonceStr,timestamp:timestamp,url:$location.absUrl().split("#")[0]},string=raw(ret),signature=signSha1(string),config={appId:easybuy.weixinAppId,timestamp:timestamp,nonceStr:nonceStr,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"],signature:signature};$(document).ready(function(){wx.config(config),wx.ready(function(){wx.onMenuShareTimeline({title:desc,link:link+"1",imgUrl:imgUrl,success:function(){$scope.fadeOutShare();{var tokenInfo=getToken();"platform=all&token="+tokenInfo.token}},cancel:function(){}}),wx.onMenuShareAppMessage({title:title,desc:desc,link:link+"2",imgUrl:imgUrl,type:"link",dataUrl:"",success:function(){},cancel:function(){}})}),wx.error(function(res){alertWarning(JSON.stringify(res))})})};if(easybuy.isWechat)if(!getWxSdkToken()||getWxSdkToken()&&!getWxSdkToken().ticket){var data="platform=all";httpRequest.APIPOST("/wx/data?platform=all",null,{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){var data=result.result;setWxSdkToken({accessToken:data.access_token,ticket:data.ticket}),weixinSdkConfig()}else alert(result.msg)})}else weixinSdkConfig();if($scope.goTo=function(index){for(var g=[],i=0;i<$scope.products.length;i++)g.push($scope.products[i].goodsId);index<=g.length&&($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+g[index-1]:$location.path("/product/"+g[index-1]+"/1"))},$scope.goProduct=function(id){return id?void($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+id:$location.path("/product/"+id+"/1")):void alertWarning("该商品已经下架，请选择其他商品购买^_^")},$scope.buyNow=function(path,action){$scope.isApp?window.location.href=easybuy.appActivity+"?action="+action:$location.path("/"+path)},$scope.more=function(){$scope.isApp?window.location.href=easybuy.appActivity+"?action=5":$location.path("/products")},$scope.shareToFriends=function(){if($scope.isApp)return void(window.location.href=easybuy.appActivity+"?action=3&shareTitle="+title+"&shareText="+desc+"&shareUrl="+link+"&shareImageUrl="+imgUrl+"&title=【糖村】新年好礼！");if(easybuy.isWechat){var tokenInfo=getToken();tokenInfo&&tokenInfo.token&&tokenInfo.openId?$scope.fadeInShare():$location.path("/wechatOauth/activity-activityDetail")}else{var arrButton=["确定"];openDialog("请在微信内打开并分享到朋友圈","",arrButton,null,function(r){})}},$scope.shareSuccess=function(){},$scope.back=function(){$location.path("/products")},$scope.fadeOutShare=function(){$("#shareHint").fadeOut()},$scope.fadeInShare=function(){$("#shareHint").fadeIn()},$location.search()){var actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId||20;var data="platform=all&activityId="+actId;httpRequest.APIPOST("/activity/detail",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){if($scope.activityInfo=result.result,null==result.result)return void alertExt("该活动已结束，更多精彩活动尽在首页！",function(){$location.path("/"),$scope.$apply($location)});var act=$scope.activityInfo.activity;act.url||(act.url=""),link=act.url.indexOf("?")>0?act.url+"&activityId="+act.id+"&source=3&sharedTo=":act.url+"?activityId="+act.id+"&source=3&sharedTo=",imgUrl=act.img,title=act.name,desc=act.desc,$scope.products=[],$scope.activityInfo&&$scope.activityInfo.fullGiveGoodsList&&($scope.products=$scope.activityInfo.fullGiveGoodsList)}else alert(result.msg+":ctivity-detail")})}if($location.search()&&$location.search().sharedTo&&$location.search().source){var actId=($location.search(),""),channel=$location.search().sharedTo||1;channel instanceof Array&&(channel=1);{var platform=$location.search().source||"all";$location.search().pageType||""}platform=1==platform?"android":2==platform?"ios":"all",actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId;var token="";getToken()&&(token="&token="+getToken().token);var data="activityId="+actId+"&channel="+channel+"&platform="+platform+token;httpRequest.APIPOST("/activity/clickLog",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success})}else{var platform=$location.search().platform||"all",token=$location.search().token||"",actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId,token?token="&token="+token:getToken()&&(token="&token="+getToken().token);var data="activityId="+actId+"&type=2&platform="+platform+token;httpRequest.APIPOST("/activity/clickLog",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success})}}),app.register.controller("activityMayController",function($rootScope,$scope,httpRequest,dataStringify,signSha1,analytics,$location){$scope.isShowNavbar=!1,$scope.isApp=isApp($location),$scope.isShowNavbar=$scope.isApp?!1:!0;var link="http://goeasy.yhiker.com/#/activity/beautySummer?source=3&sharedTo=",imgUrl="http://goeasy.yhiker.com/image/activity/beautySummer/banner.jpg",title="购轻松台湾",desc="美丽一夏",createNonceStr=function(){return Math.random().toString(36).substr(2,15)},createTimestamp=function(){return parseInt((new Date).getTime()/1e3)+""},raw=function(args){var keys=Object.keys(args);keys=keys.sort();var newArgs={};keys.forEach(function(key){newArgs[key.toLowerCase()]=args[key]});var string="";for(var k in newArgs)string+="&"+k+"="+newArgs[k];return string=string.substr(1)},nonceStr=createNonceStr(),timestamp=createTimestamp(),weixinSdkConfig=function(){$scope.ticket=getWxSdkToken().ticket;var ret={jsapi_ticket:getWxSdkToken().ticket,nonceStr:nonceStr,timestamp:timestamp,url:$location.absUrl().split("#")[0]},string=raw(ret),signature=signSha1(string),config={appId:easybuy.weixinAppId,timestamp:timestamp,nonceStr:nonceStr,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"],signature:signature};$(document).ready(function(){wx.config(config),wx.ready(function(){wx.onMenuShareTimeline({title:desc,link:link+"1",imgUrl:imgUrl,success:function(){$scope.fadeOutShare();{var tokenInfo=getToken();"platform=all&token="+tokenInfo.token}},cancel:function(){}}),wx.onMenuShareAppMessage({title:title,desc:desc,link:link+"2",imgUrl:imgUrl,type:"link",dataUrl:"",success:function(){},cancel:function(){}})}),wx.error(function(res){alertWarning(JSON.stringify(res))})})};if(easybuy.isWechat)if(!getWxSdkToken()||getWxSdkToken()&&!getWxSdkToken().ticket){var data="platform=all";httpRequest.APIPOST("/wx/data?platform=all",null,{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){var data=result.result;setWxSdkToken({accessToken:data.access_token,ticket:data.ticket}),weixinSdkConfig()}else alert(result.msg)})}else weixinSdkConfig();if($scope.goTo=function(index){for(var g=[],i=0;i<$scope.products.length;i++)g.push($scope.products[i].goodsId);index<=g.length&&($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+g[index-1]:$location.path("/product/"+g[index-1]+"/1"))},$scope.goProduct=function(id){return id?void($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+id:$location.path("/product/"+id+"/1")):void alertWarning("该商品已经下架，请选择其他商品购买^_^")},$scope.more=function(){$scope.isApp?window.location.href=easybuy.appActivity+"?action=5":$location.path("/products")},$scope.shareToFriends=function(){if($scope.isApp)return void(window.location.href=easybuy.appActivity+"?action=3&shareTitle="+title+"&shareText="+desc+"&shareUrl="+link+"&shareImageUrl="+imgUrl+"&title=【糖村】新年好礼！");if(easybuy.isWechat){var tokenInfo=getToken();tokenInfo&&tokenInfo.token&&tokenInfo.openId?$scope.fadeInShare():$location.path("/wechatOauth/activity-activityDetail")}else{var arrButton=["确定"];openDialog("请在微信内打开并分享到朋友圈","",arrButton,null,function(r){})}},$scope.shareSuccess=function(){},$scope.back=function(){$location.path("/products")},$scope.fadeOutShare=function(){$("#shareHint").fadeOut()
},$scope.fadeInShare=function(){$("#shareHint").fadeIn()},$location.search()){var actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId||20;var data="platform=all&activityId="+actId;httpRequest.APIPOST("/activity/detail",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){if($scope.activityInfo=result.result,null==result.result)return void alertExt("该活动已结束，更多精彩活动尽在首页！",function(){$location.path("/"),$scope.$apply($location)});var act=$scope.activityInfo.activity;act.url||(act.url=""),link=act.url.indexOf("?")>0?act.url+"&activityId="+act.id+"&source=3&sharedTo=":act.url+"?activityId="+act.id+"&source=3&sharedTo=",imgUrl=act.img,title=act.name,desc=act.desc,$scope.products=[],$scope.activityInfo&&$scope.activityInfo.fullGiveGoodsList&&($scope.products=$scope.activityInfo.fullGiveGoodsList)}else alert(result.msg+":ctivity-detail")})}if($location.search()&&$location.search().sharedTo&&$location.search().source){var actId=($location.search(),""),channel=$location.search().sharedTo||1;channel instanceof Array&&(channel=1);{var platform=$location.search().source||"all";$location.search().pageType||""}platform=1==platform?"android":2==platform?"ios":"all",actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId;var token="";getToken()&&(token="&token="+getToken().token);var data="activityId="+actId+"&channel="+channel+"&platform="+platform+token;httpRequest.APIPOST("/activity/clickLog",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success})}}),app.register.controller("activitybeautySummerController",function($rootScope,$scope,httpRequest,dataStringify,signSha1,analytics,$location){$scope.isShowNavbar=!1,$scope.isApp=isApp($location),$scope.isShowNavbar=$scope.isApp?!1:!0;var link="http://goeasy.yhiker.com/#/activity/beautySummer?source=3&sharedTo=",imgUrl="http://goeasy.yhiker.com/image/activity/beautySummer/banner.jpg",title="购轻松台湾",desc="美丽一夏",createNonceStr=function(){return Math.random().toString(36).substr(2,15)},createTimestamp=function(){return parseInt((new Date).getTime()/1e3)+""},raw=function(args){var keys=Object.keys(args);keys=keys.sort();var newArgs={};keys.forEach(function(key){newArgs[key.toLowerCase()]=args[key]});var string="";for(var k in newArgs)string+="&"+k+"="+newArgs[k];return string=string.substr(1)},nonceStr=createNonceStr(),timestamp=createTimestamp(),weixinSdkConfig=function(){$scope.ticket=getWxSdkToken().ticket;var ret={jsapi_ticket:getWxSdkToken().ticket,nonceStr:nonceStr,timestamp:timestamp,url:$location.absUrl().split("#")[0]},string=raw(ret),signature=signSha1(string),config={appId:easybuy.weixinAppId,timestamp:timestamp,nonceStr:nonceStr,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"],signature:signature};$(document).ready(function(){wx.config(config),wx.ready(function(){wx.onMenuShareTimeline({title:desc,link:link+"1",imgUrl:imgUrl,success:function(){$scope.fadeOutShare();{var tokenInfo=getToken();"platform=all&token="+tokenInfo.token}},cancel:function(){}}),wx.onMenuShareAppMessage({title:title,desc:desc,link:link+"2",imgUrl:imgUrl,type:"link",dataUrl:"",success:function(){},cancel:function(){}})}),wx.error(function(res){alertWarning(JSON.stringify(res))})})};if(easybuy.isWechat)if(!getWxSdkToken()||getWxSdkToken()&&!getWxSdkToken().ticket){var data="platform=all";httpRequest.APIPOST("/wx/data?platform=all",null,{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){var data=result.result;setWxSdkToken({accessToken:data.access_token,ticket:data.ticket}),weixinSdkConfig()}else alert(result.msg)})}else weixinSdkConfig();if($scope.goTo=function(index){for(var g=[],i=0;i<$scope.products.length;i++)g.push($scope.products[i].goodsId);index<=g.length&&($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+g[index-1]:$location.path("/product/"+g[index-1]+"/1"))},$scope.goProduct=function(id){return id?void($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+id:$location.path("/product/"+id+"/1")):void alertWarning("该商品已经下架，请选择其他商品购买^_^")},$scope.more=function(){$scope.isApp?window.location.href=easybuy.appActivity+"?action=5":$location.path("/products")},$scope.shareToFriends=function(){if($scope.isApp)return void(window.location.href=easybuy.appActivity+"?action=3&shareTitle="+title+"&shareText="+desc+"&shareUrl="+link+"&shareImageUrl="+imgUrl+"&title=【糖村】新年好礼！");if(easybuy.isWechat){var tokenInfo=getToken();tokenInfo&&tokenInfo.token&&tokenInfo.openId?$scope.fadeInShare():$location.path("/wechatOauth/activity-activityDetail")}else{var arrButton=["确定"];openDialog("请在微信内打开并分享到朋友圈","",arrButton,null,function(r){})}},$scope.shareSuccess=function(){},$scope.back=function(){$location.path("/products")},$scope.fadeOutShare=function(){$("#shareHint").fadeOut()},$scope.fadeInShare=function(){$("#shareHint").fadeIn()},$location.search()){var actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId||19;var data="platform=all&activityId="+actId;httpRequest.APIPOST("/activity/detail",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){if($scope.activityInfo=result.result,null==result.result)return void alertExt("该活动已结束，更多精彩活动尽在首页！",function(){$location.path("/"),$scope.$apply($location)});var act=$scope.activityInfo.activity;act.url||(act.url=""),link=act.url.indexOf("?")>0?act.url+"&activityId="+act.id+"&source=3&sharedTo=":act.url+"?activityId="+act.id+"&source=3&sharedTo=",imgUrl=act.img,title=act.name,desc=act.desc,$scope.products=[],$scope.activityInfo&&$scope.activityInfo.fullGiveGoodsList&&($scope.products=$scope.activityInfo.fullGiveGoodsList)}else alert(result.msg+":ctivity-detail")})}if($location.search()&&$location.search().sharedTo&&$location.search().source){var actId=($location.search(),""),channel=$location.search().sharedTo||1;channel instanceof Array&&(channel=1);{var platform=$location.search().source||"all";$location.search().pageType||""}platform=1==platform?"android":2==platform?"ios":"all",actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId;var token="";getToken()&&(token="&token="+getToken().token);var data="activityId="+actId+"&channel="+channel+"&platform="+platform+token;httpRequest.APIPOST("/activity/clickLog",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success})}}),app.register.controller("activityMothersDayController",function($rootScope,$scope,httpRequest,dataStringify,signSha1,analytics,$location){$scope.isShowNavbar=!1,$scope.isApp=isApp($location),$scope.isShowNavbar=$scope.isApp?!1:!0;var link="http://goeasy.yhiker.com/#/activity/mothersDay?source=3&sharedTo=",imgUrl="http://goeasy.yhiker.com/image/activity/mothersDay/banner.jpg",title="购轻松台湾",desc="母亲节 送妈妈的好礼物",createNonceStr=function(){return Math.random().toString(36).substr(2,15)},createTimestamp=function(){return parseInt((new Date).getTime()/1e3)+""},raw=function(args){var keys=Object.keys(args);keys=keys.sort();var newArgs={};keys.forEach(function(key){newArgs[key.toLowerCase()]=args[key]});var string="";for(var k in newArgs)string+="&"+k+"="+newArgs[k];return string=string.substr(1)},nonceStr=createNonceStr(),timestamp=createTimestamp(),weixinSdkConfig=function(){$scope.ticket=getWxSdkToken().ticket;var ret={jsapi_ticket:getWxSdkToken().ticket,nonceStr:nonceStr,timestamp:timestamp,url:$location.absUrl().split("#")[0]},string=raw(ret),signature=signSha1(string),config={appId:easybuy.weixinAppId,timestamp:timestamp,nonceStr:nonceStr,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"],signature:signature};$(document).ready(function(){wx.config(config),wx.ready(function(){wx.onMenuShareTimeline({title:desc,link:link+"1",imgUrl:imgUrl,success:function(){$scope.fadeOutShare();{var tokenInfo=getToken();"platform=all&token="+tokenInfo.token}},cancel:function(){}}),wx.onMenuShareAppMessage({title:title,desc:desc,link:link+"2",imgUrl:imgUrl,type:"link",dataUrl:"",success:function(){},cancel:function(){}})}),wx.error(function(res){alertWarning(JSON.stringify(res))})})};if(easybuy.isWechat)if(!getWxSdkToken()||getWxSdkToken()&&!getWxSdkToken().ticket){var data="platform=all";httpRequest.APIPOST("/wx/data?platform=all",null,{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){var data=result.result;setWxSdkToken({accessToken:data.access_token,ticket:data.ticket}),weixinSdkConfig()}else alert(result.msg)})}else weixinSdkConfig();if($scope.goTo=function(index){for(var g=[],i=0;i<$scope.products.length;i++)g.push($scope.products[i].goodsId);index<=g.length&&($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+g[index-1]:$location.path("/product/"+g[index-1]+"/1"))},$scope.goProduct=function(id){return id?void($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+id:$location.path("/product/"+id+"/1")):void alertWarning("该商品已经下架，请选择其他商品购买^_^")},$scope.more=function(){$scope.isApp?window.location.href=easybuy.appActivity+"?action=5":$location.path("/products")},$scope.shareToFriends=function(){if($scope.isApp)return void(window.location.href=easybuy.appActivity+"?action=3&shareTitle="+title+"&shareText="+desc+"&shareUrl="+link+"&shareImageUrl="+imgUrl+"&title=【糖村】新年好礼！");if(easybuy.isWechat){var tokenInfo=getToken();tokenInfo&&tokenInfo.token&&tokenInfo.openId?$scope.fadeInShare():$location.path("/wechatOauth/activity-activityDetail")}else{var arrButton=["确定"];openDialog("请在微信内打开并分享到朋友圈","",arrButton,null,function(r){})}},$scope.shareSuccess=function(){},$scope.back=function(){$location.path("/products")},$scope.fadeOutShare=function(){$("#shareHint").fadeOut()},$scope.fadeInShare=function(){$("#shareHint").fadeIn()},$location.search()){var actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId||20;var data="platform=all&activityId="+actId;httpRequest.APIPOST("/activity/detail",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){if($scope.activityInfo=result.result,null==result.result)return void alertExt("该活动已结束，更多精彩活动尽在首页！",function(){$location.path("/"),$scope.$apply($location)});var act=$scope.activityInfo.activity;act.url||(act.url=""),link=act.url.indexOf("?")>0?act.url+"&activityId="+act.id+"&source=3&sharedTo=":act.url+"?activityId="+act.id+"&source=3&sharedTo=",imgUrl=act.img,title=act.name,desc=act.desc,$scope.products=[],$scope.activityInfo&&$scope.activityInfo.downPriceGoodsList&&($scope.products=$scope.activityInfo.downPriceGoodsList)}else alert(result.msg+":ctivity-detail")})}if($location.search()&&$location.search().sharedTo&&$location.search().source){var actId=($location.search(),""),channel=$location.search().sharedTo||1;channel instanceof Array&&(channel=1);{var platform=$location.search().source||"all";$location.search().pageType||""}platform=1==platform?"android":2==platform?"ios":"all",actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId;var token="";getToken()&&(token="&token="+getToken().token);var data="activityId="+actId+"&channel="+channel+"&platform="+platform+token;httpRequest.APIPOST("/activity/clickLog",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success})}}),app.register.controller("activityXblPriceController",function($rootScope,$scope,httpRequest,dataStringify,signSha1,analytics,$location){$scope.isShowNavbar=!1,$scope.isApp=isApp($location),$scope.isShowNavbar=$scope.isApp?!1:!0;var link="http://goeasy.yhiker.com/#/activity/xbl?source=3&sharedTo=",imgUrl="http://goeasy.yhiker.com/image/activity/xbl/ad.jpg",title="购轻松台湾",desc="台湾小背篓";forApp.shareSuccess=function(token,category,id,channel){debugModel("activity-token:"+token+"category:"+category+"id:"+id+"channel:"+channel)},forApp.shareFailed=function(token,category,id,channel){debugModel("activity-token:"+token+"category:"+category+"id:"+id+"channel:"+channel)},forApp.loginSuccess=function(token){debugModel("activity-token:"+token)},$scope.share=function(){$scope.isApp&&(window.location.href=easybuy.appActivity+"?action=3&mustLogin=1&shareTitle=testTitle&shareText=testText&shareUrl="+$location.absUrl()+"&shareImageUrl=image")},$scope.prize=0,$scope.choosePrize=function(type){$scope.prize=type},$scope.option1=0,$scope.option2=0,$scope.option3=0,$scope.option4=0,$scope.chooseOption1=function(){$scope.option1=$scope.option1?0:1},$scope.chooseOption2=function(){$scope.option2=$scope.option2?0:2},$scope.chooseOption3=function(){$scope.option3=$scope.option3?0:3},$scope.chooseOption4=function(){$scope.option4=$scope.option4?0:4},$scope.status=0,$scope.submit=function(){if(1!=$scope.status){if(!$scope.prize)return void alertWarning("请选择奖品");if(!$scope.name)return void alertWarning("请输入您的姓名");if(!$scope.mobile)return void alertWarning("请输入您的号码");if($scope.mobile.length<8||$scope.mobile.length>13)return void alertWarning("请输入8-13位的号码");var goodsType="";if(!($scope.option1||$scope.option2||$scope.option3||$scope.option4))return void alertWarning("请选择背货类型");$scope.option1&&(goodsType=goodsType+$scope.option1+","),$scope.option2&&(goodsType=goodsType+$scope.option2+","),$scope.option3&&(goodsType=goodsType+$scope.option3+","),$scope.option4&&(goodsType=goodsType+$scope.option4+","),goodsType=goodsType.substr(0,goodsType.length-1);var param="platform=all&name="+$scope.name+"&mobile="+$scope.mobile+"&prize="+$scope.prize+"&goodsType="+goodsType;httpRequest.APIPOST("/activity/packBasketer",dataStringify(param),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success?($scope.status=1,alertWarning("恭喜您报名成功！")):alertWarning(result.msg)})}},$scope.initUI=function(){var clientWidth=$(document).width();if(640>clientWidth){var rate=clientWidth/640,pW=$(".products").width(),pH=$(".products").height(),pWD=$(".products div").width(),pHD=$(".products div").height(),pT=parseInt($(".products").css("top").substr(0,$(".products").css("top").length-2)),pL=parseInt($(".products").css("left").substr(0,$(".products").css("left").length-2)),pDIL=parseInt($(".products div img").css("left").substr(0,$(".products div img").css("left").length-2)),pDIB=parseInt($(".products div img").css("bottom").substr(0,$(".products div img").css("bottom").length-2)),pDIW=38;$(".products").width(pW*rate),$(".products").height(pH*rate),$(".products div").width(pWD*rate),$(".products div").height(pHD*rate),$(".products").css("top",pT*rate+"px"),$(".products").css("left",pL*rate+"px"),$(".products div img").css("bottom",pDIB*rate+"px"),$(".products div img").css("left",pDIL*rate+"px"),$(".products div img").width(pDIW*rate);var oW=$(".option").width(),oH=$(".option").height(),oWD=$(".option div").width(),oHD=$(".option div").height(),oB=parseInt($(".option").css("bottom").substr(0,$(".option").css("bottom").length-2)),oL=parseInt($(".option").css("left").substr(0,$(".option").css("left").length-2)),oDIW=38;$(".option").width(oW*rate),$(".option").height(oH*rate),$(".option div").width(oWD*rate),$(".option div").height(oHD*rate),$(".option").css("bottom",oB*rate+"px"),$(".option").css("left",oL*rate+"px"),$(".option div img").width(oDIW*rate);var iconW=$(".icon_button").width(),iconB=parseInt($(".icon_button").css("bottom").substr(0,$(".icon_button").css("bottom").length-2)),iconL=parseInt($(".icon_button").css("left").substr(0,$(".icon_button").css("left").length-2));$(".icon_button").width(iconW*rate),$(".icon_button").css("bottom",iconB*rate+"px"),$(".icon_button").css("left",iconL*rate+"px");var iW=$(".input_name").width(),iH=$(".input_name").height(),iWD=$(".input_name div input").width(),iHD=$(".input_name div input").height(),iT=parseInt($(".input_name").css("top").substr(0,$(".input_name").css("top").length-2)),iL=parseInt($(".input_name").css("left").substr(0,$(".input_name").css("left").length-2)),iDIL=parseInt($(".input_name div input").css("margin-bottom").substr(0,$(".input_name div input").css("margin-bottom").length-2));$(".input_name").width(iW*rate),$(".input_name").height(iH*rate),$(".input_name div input").width(iWD*rate),$(".input_name div input").height(iHD*rate),$(".input_name").css("top",iT*rate+"px"),$(".input_name").css("left",iL*rate+"px"),$(".input_name div input").css("margin-bottom",iDIL*rate+"px")}},$scope.initUI(),$(window).resize(function(){setTimeout(function(){},100)});var createNonceStr=function(){return Math.random().toString(36).substr(2,15)},createTimestamp=function(){return parseInt((new Date).getTime()/1e3)+""},raw=function(args){var keys=Object.keys(args);keys=keys.sort();var newArgs={};keys.forEach(function(key){newArgs[key.toLowerCase()]=args[key]});var string="";for(var k in newArgs)string+="&"+k+"="+newArgs[k];return string=string.substr(1)},nonceStr=createNonceStr(),timestamp=createTimestamp(),weixinSdkConfig=function(){$scope.ticket=getWxSdkToken().ticket;var ret={jsapi_ticket:getWxSdkToken().ticket,nonceStr:nonceStr,timestamp:timestamp,url:$location.absUrl().split("#")[0]},string=raw(ret),signature=signSha1(string),config={appId:easybuy.weixinAppId,timestamp:timestamp,nonceStr:nonceStr,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"],signature:signature};$(document).ready(function(){wx.config(config),wx.ready(function(){wx.onMenuShareTimeline({title:desc,link:link+"1",imgUrl:imgUrl,success:function(){$scope.fadeOutShare();{var tokenInfo=getToken();"platform=all&token="+tokenInfo.token}},cancel:function(){}}),wx.onMenuShareAppMessage({title:title,desc:desc,link:link+"2",imgUrl:imgUrl,type:"link",dataUrl:"",success:function(){},cancel:function(){}})}),wx.error(function(res){alertWarning(JSON.stringify(res))})})};if(easybuy.isWechat)if(!getWxSdkToken()||getWxSdkToken()&&!getWxSdkToken().ticket){var data="platform=all";httpRequest.APIPOST("/wx/data?platform=all",null,{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){var data=result.result;setWxSdkToken({accessToken:data.access_token,ticket:data.ticket}),weixinSdkConfig()}else alert(result.msg)})}else weixinSdkConfig();if($scope.back=function(){$location.path("/products")},$location.search()){var actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId||18;var data="platform=all&activityId="+actId;httpRequest.APIPOST("/activity/detail",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){if($scope.activityInfo=result.result,null==result.result)return void alertExt("该活动已结束，更多精彩活动尽在首页！",function(){$location.path("/"),$scope.$apply($location)});var act=$scope.activityInfo.activity;act.url||(act.url=""),link=act.url.indexOf("?")>0?act.url+"&activityId="+act.id+"&source=3&sharedTo=":act.url+"?activityId="+act.id+"&source=3&sharedTo=",imgUrl=act.img,title=act.name,desc=act.desc,$scope.products=[],$scope.activityInfo&&$scope.activityInfo.fullGiveGoodsList&&($scope.products=$scope.activityInfo.halfPriceGoodsList)}else alert(result.msg+":ctivity-detail")})}}),app.register.controller("activityHalfPriceController",function($rootScope,$scope,httpRequest,dataStringify,signSha1,analytics,$location){$scope.isShowNavbar=!1,$scope.isApp=isApp($location),$scope.isShowNavbar=$scope.isApp?!1:!0;var link="http://goeasy.yhiker.com/#/activity/half?source=3&sharedTo=",imgUrl="http://goeasy.yhiker.com/image/activity/half/ad.jpg",title="购轻松台湾",desc="森田药妆第二件半价",createNonceStr=function(){return Math.random().toString(36).substr(2,15)},createTimestamp=function(){return parseInt((new Date).getTime()/1e3)+""},raw=function(args){var keys=Object.keys(args);keys=keys.sort();var newArgs={};keys.forEach(function(key){newArgs[key.toLowerCase()]=args[key]});var string="";for(var k in newArgs)string+="&"+k+"="+newArgs[k];return string=string.substr(1)},nonceStr=createNonceStr(),timestamp=createTimestamp(),weixinSdkConfig=function(){$scope.ticket=getWxSdkToken().ticket;var ret={jsapi_ticket:getWxSdkToken().ticket,nonceStr:nonceStr,timestamp:timestamp,url:$location.absUrl().split("#")[0]},string=raw(ret),signature=signSha1(string),config={appId:easybuy.weixinAppId,timestamp:timestamp,nonceStr:nonceStr,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"],signature:signature};$(document).ready(function(){wx.config(config),wx.ready(function(){wx.onMenuShareTimeline({title:desc,link:link+"1",imgUrl:imgUrl,success:function(){$scope.fadeOutShare();{var tokenInfo=getToken();"platform=all&token="+tokenInfo.token}},cancel:function(){}}),wx.onMenuShareAppMessage({title:title,desc:desc,link:link+"2",imgUrl:imgUrl,type:"link",dataUrl:"",success:function(){},cancel:function(){}})}),wx.error(function(res){alertWarning(JSON.stringify(res))})})};if(easybuy.isWechat)if(!getWxSdkToken()||getWxSdkToken()&&!getWxSdkToken().ticket){var data="platform=all";httpRequest.APIPOST("/wx/data?platform=all",null,{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){var data=result.result;setWxSdkToken({accessToken:data.access_token,ticket:data.ticket}),weixinSdkConfig()}else alert(result.msg)})}else weixinSdkConfig();if($scope.goTo=function(index){for(var g=[],i=0;i<$scope.products.length;i++)g.push($scope.products[i].goodsId);index<=g.length&&($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+g[index-1]:$location.path("/product/"+g[index-1]+"/1"))},$scope.goProduct=function(id){return id?void($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+id:$location.path("/product/"+id+"/1")):void alertWarning("该商品已经下架，请选择其他商品购买^_^")},$scope.more=function(){$scope.isApp?window.location.href=easybuy.appActivity+"?action=5":$location.path("/products")},$scope.shareToFriends=function(){if($scope.isApp)return void(window.location.href=easybuy.appActivity+"?action=3&shareTitle="+title+"&shareText="+desc+"&shareUrl="+link+"&shareImageUrl="+imgUrl+"&title=【糖村】新年好礼！");if(easybuy.isWechat){var tokenInfo=getToken();tokenInfo&&tokenInfo.token&&tokenInfo.openId?$scope.fadeInShare():$location.path("/wechatOauth/activity-activityDetail")}else{var arrButton=["确定"];openDialog("请在微信内打开并分享到朋友圈","",arrButton,null,function(r){})}},$scope.shareSuccess=function(){},$scope.back=function(){$location.path("/products")},$scope.fadeOutShare=function(){$("#shareHint").fadeOut()},$scope.fadeInShare=function(){$("#shareHint").fadeIn()},$location.search()){var actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId||14;var data="platform=all&activityId="+actId;httpRequest.APIPOST("/activity/detail",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){if($scope.activityInfo=result.result,null==result.result)return void alertExt("该活动已结束，更多精彩活动尽在首页！",function(){$location.path("/"),$scope.$apply($location)});var act=$scope.activityInfo.activity;act.url||(act.url=""),link=act.url.indexOf("?")>0?act.url+"&activityId="+act.id+"&source=3&sharedTo=":act.url+"?activityId="+act.id+"&source=3&sharedTo=",imgUrl=act.img,title=act.name,desc=act.desc,$scope.products=[],$scope.activityInfo&&$scope.activityInfo.halfPriceGoodsList&&($scope.products=$scope.activityInfo.halfPriceGoodsList)}else alert(result.msg+":ctivity-detail")})}if($location.search()&&$location.search().sharedTo&&$location.search().source){var actId=($location.search(),""),channel=$location.search().sharedTo||1;channel instanceof Array&&(channel=1);{var platform=$location.search().source||"all";$location.search().pageType||""}platform=1==platform?"android":2==platform?"ios":"all",actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId;var token="";getToken()&&(token="&token="+getToken().token);var data="activityId="+actId+"&channel="+channel+"&platform="+platform+token;httpRequest.APIPOST("/activity/clickLog",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success})}else{var platform=$location.search().platform||"all",token=$location.search().token||"",actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId,token?token="&token="+token:getToken()&&(token="&token="+getToken().token);var data="activityId="+actId+"&type=2&platform="+platform+token;httpRequest.APIPOST("/activity/clickLog",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success})}}),app.register.controller("activityXrhlController",function($rootScope,$scope,httpRequest,dataStringify,signSha1,analytics,$location){$scope.isShowNavbar=!1,$scope.isApp=isApp($location),$scope.isShowNavbar=$scope.isApp?!1:!0;var link="http://goeasy.yhiker.com/#/activity/xrhl?source=3&sharedTo=",imgUrl="http://goeasy.yhiker.com/image/activity/xrhl/ad.png",title="购轻松台湾",desc="新人尊享，豪华大礼免费领",createNonceStr=function(){return Math.random().toString(36).substr(2,15)},createTimestamp=function(){return parseInt((new Date).getTime()/1e3)+""},raw=function(args){var keys=Object.keys(args);keys=keys.sort();var newArgs={};keys.forEach(function(key){newArgs[key.toLowerCase()]=args[key]});var string="";for(var k in newArgs)string+="&"+k+"="+newArgs[k];return string=string.substr(1)},nonceStr=createNonceStr(),timestamp=createTimestamp(),weixinSdkConfig=function(){$scope.ticket=getWxSdkToken().ticket;var ret={jsapi_ticket:getWxSdkToken().ticket,nonceStr:nonceStr,timestamp:timestamp,url:$location.absUrl().split("#")[0]},string=raw(ret),signature=signSha1(string),config={appId:easybuy.weixinAppId,timestamp:timestamp,nonceStr:nonceStr,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"],signature:signature};$(document).ready(function(){wx.config(config),wx.ready(function(){wx.onMenuShareTimeline({title:desc,link:link+"1",imgUrl:imgUrl,success:function(){$scope.fadeOutShare();{var tokenInfo=getToken();"platform=all&token="+tokenInfo.token}},cancel:function(){$scope.fadeOutShare()}}),wx.onMenuShareAppMessage({title:title,desc:desc,link:link+"2",imgUrl:imgUrl,type:"link",dataUrl:"",success:function(){$scope.fadeOutShare(),alertWarning("发送成功！")},cancel:function(){}})}),wx.error(function(res){alertWarning(JSON.stringify(res))})})};if(easybuy.isWechat)if(!getWxSdkToken()||getWxSdkToken()&&!getWxSdkToken().ticket){var data="platform=all";httpRequest.APIPOST("/wx/data?platform=all",null,{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){var data=result.result;setWxSdkToken({accessToken:data.access_token,ticket:data.ticket}),weixinSdkConfig()}else alert(result.msg)})}else weixinSdkConfig();if($scope.goTo=function(type,action){var tokenInfo=getToken(),isLogin=!1;if(tokenInfo&&tokenInfo.token&&(isLogin=!0),$scope.isApp)window.location.href=easybuy.appActivity+"?action="+action;else if(1==type){if(!isLogin)return void redirectLogin($location,"activity-xrhl");$scope.getCoupons(tokenInfo.token)}else if("myCoupon"==type){if(!isLogin)return void openDialog("您还没登录呢！",null,["确定"]);$scope.getCashCoupons(tokenInfo.token,type)}else $location.path("/"+type)},$scope.getCoupons=function(token){var data="platform=all&token="+token;httpRequest.APIPOST("/user/getCoupons",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){var msg=result.msg;alertWarning("恭喜您领取成功！")}else{var msg=result.msg;openDialog(msg,null,["确定"])}})},$scope.getCashCoupons=function(token,path){var data="platform=all&token="+token;httpRequest.APIPOST("/user/checkCoupons",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){var msg=result.msg;$location.path("/"+path).search({from:"activity"})}else{var msg=result.msg;openDialog(msg,null,["确定"])}})},$location.search()&&$location.search().nickname&&$location.search().timestamp&&$location.search().version&&$scope.getCoupons($location.search().token),$scope.shareToFriends=function(){if($scope.isApp)return void(window.location.href=easybuy.appActivity+"?action=3&shareTitle="+title+"&shareText="+desc+"&shareUrl="+link+"&shareImageUrl="+imgUrl+"&title=【糖村】新年好礼！");if(easybuy.isWechat){var tokenInfo=getToken();tokenInfo&&tokenInfo.token&&tokenInfo.openId?$scope.fadeInShare():$location.path("/wechatOauth/activity-activityDetail")}else{var arrButton=["确定"];openDialog("请在微信内打开并分享到朋友圈","",arrButton,null,function(r){})}},$scope.shareSuccess=function(){},$scope.back=function(){$location.path("/products")},$scope.fadeOutShare=function(){$("#shareHint").fadeOut()},$scope.fadeInShare=function(){$("#shareHint").fadeIn()},$location.search()&&$location.search().activityId){var actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId;var data="platform=all&activityId="+actId;httpRequest.APIPOST("/activity/detail",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){if($scope.activityInfo=result.result,null==result.result)return void alertExt("该活动已结束，更多精彩活动尽在首页！",function(){$location.path("/"),$scope.$apply($location)});var act=$scope.activityInfo.activity;link=act.url.indexOf("?")>0?act.url+"&activityId="+act.id+"&source=3&sharedTo=":act.url+"?activityId="+act.id+"&source=3&sharedTo=",imgUrl=act.img,title=act.name,desc=act.desc}else alert(result.msg)})}if($location.search()&&$location.search().sharedTo&&$location.search().source){var actId=($location.search(),""),channel=$location.search().sharedTo||1;channel instanceof Array&&(channel=1);{var platform=$location.search().source||"all";$location.search().pageType||""}platform=1==platform?"android":2==platform?"ios":"all",actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId;var token="";getToken()&&(token="&token="+getToken().token);var data="activityId="+actId+"&channel="+channel+"&platform="+platform+token;httpRequest.APIPOST("/activity/clickLog",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success})}else{var platform=$location.search().platform||"all",token=$location.search().token||"",actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId,token?token="&token="+token:getToken()&&(token="&token="+getToken().token);var data="activityId="+actId+"&type=2&platform="+platform+token;httpRequest.APIPOST("/activity/clickLog",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success})}}),app.register.controller("activityFullController",function($rootScope,$scope,httpRequest,dataStringify,signSha1,analytics,$location){$scope.isShowNavbar=!1,$scope.isApp=isApp($location),$scope.isShowNavbar=$scope.isApp?!1:!0;var link="http://goeasy.yhiker.com/#/activity/full?source=3&sharedTo=",imgUrl="http://goeasy.yhiker.com/image/activity/full/ad.jpg",title="购轻松台湾",desc="台湾第一伴手礼—【糖村】甜蜜来袭，分享就送100元",createNonceStr=function(){return Math.random().toString(36).substr(2,15)
},createTimestamp=function(){return parseInt((new Date).getTime()/1e3)+""},raw=function(args){var keys=Object.keys(args);keys=keys.sort();var newArgs={};keys.forEach(function(key){newArgs[key.toLowerCase()]=args[key]});var string="";for(var k in newArgs)string+="&"+k+"="+newArgs[k];return string=string.substr(1)},nonceStr=createNonceStr(),timestamp=createTimestamp(),weixinSdkConfig=function(){$scope.ticket=getWxSdkToken().ticket;var ret={jsapi_ticket:getWxSdkToken().ticket,nonceStr:nonceStr,timestamp:timestamp,url:$location.absUrl().split("#")[0]},string=raw(ret),signature=signSha1(string),config={appId:easybuy.weixinAppId,timestamp:timestamp,nonceStr:nonceStr,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"],signature:signature};$(document).ready(function(){wx.config(config),wx.ready(function(){wx.onMenuShareTimeline({title:desc,link:link+"1",imgUrl:imgUrl,success:function(){$scope.fadeOutShare();{var tokenInfo=getToken();"platform=all&token="+tokenInfo.token}},cancel:function(){}}),wx.onMenuShareAppMessage({title:title,desc:desc,link:link+"2",imgUrl:imgUrl,type:"link",dataUrl:"",success:function(){},cancel:function(){}})}),wx.error(function(res){alertWarning(JSON.stringify(res))})})};if(easybuy.isWechat)if(!getWxSdkToken()||getWxSdkToken()&&!getWxSdkToken().ticket){var data="platform=all";httpRequest.APIPOST("/wx/data?platform=all",null,{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){var data=result.result;setWxSdkToken({accessToken:data.access_token,ticket:data.ticket}),weixinSdkConfig()}else alert(result.msg)})}else weixinSdkConfig();if($scope.goTo=function(index){for(var g=[],i=0;i<$scope.products.length;i++)g.push($scope.products[i].goodsId);index<=g.length&&($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+g[index-1]:$location.path("/product/"+g[index-1]+"/1"))},$scope.more=function(){$scope.isApp?window.location.href=easybuy.appActivity+"?action=5":$location.path("/products")},$scope.shareToFriends=function(){if($scope.isApp)return void(window.location.href=easybuy.appActivity+"?action=3&shareTitle="+title+"&shareText="+desc+"&shareUrl="+link+"&shareImageUrl="+imgUrl+"&title=【糖村】新年好礼！");if(easybuy.isWechat){var tokenInfo=getToken();tokenInfo&&tokenInfo.token&&tokenInfo.openId?$scope.fadeInShare():$location.path("/wechatOauth/activity-activityDetail")}else{var arrButton=["确定"];openDialog("请在微信内打开并分享到朋友圈","",arrButton,null,function(r){})}},$scope.shareSuccess=function(){},$scope.back=function(){$location.path("/products")},$scope.fadeOutShare=function(){$("#shareHint").fadeOut()},$scope.fadeInShare=function(){$("#shareHint").fadeIn()},$location.search()&&$location.search().activityId){var actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId;var data="platform=all&activityId="+actId;httpRequest.APIPOST("/activity/detail",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){if($scope.activityInfo=result.result,null==result.result)return void alertExt("该活动已结束，更多精彩活动尽在首页！",function(){$location.path("/"),$scope.$apply($location)});var act=$scope.activityInfo.activity;act.url||(act.url=""),link=act.url.indexOf("?")>0?act.url+"&activityId="+act.id+"&source=3&sharedTo=":act.url+"?activityId="+act.id+"&source=3&sharedTo=",imgUrl=act.img,title=act.name,desc=act.desc,$scope.products=[],$scope.activityInfo&&$scope.activityInfo.fullGiveGoodsList&&($scope.products=$scope.activityInfo.fullGiveGoodsList)}else alert(result.msg)})}if($location.search()&&$location.search().sharedTo&&$location.search().source){var actId=($location.search(),""),channel=$location.search().sharedTo||1;channel instanceof Array&&(channel=1);{var platform=$location.search().source||"all";$location.search().pageType||""}platform=1==platform?"android":2==platform?"ios":"all",actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId;var token="";getToken()&&(token="&token="+getToken().token);var data="activityId="+actId+"&channel="+channel+"&platform="+platform+token;httpRequest.APIPOST("/activity/clickLog",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success})}}),app.register.controller("activityGuideController",function($rootScope,$scope,httpRequest,dataStringify,signSha1,analytics,$location){$scope.isShowNavbar=!1,$scope.isApp=isApp($location),$scope.isShowNavbar=$scope.isApp?!1:!0;var link="http://goeasy.yhiker.com/#/activity/guide?source=3&sharedTo=",imgUrl="http://goeasy.yhiker.com/image/activity/guide/ad.jpg",title="购轻松台湾",desc="购轻松台湾",createNonceStr=function(){return Math.random().toString(36).substr(2,15)},createTimestamp=function(){return parseInt((new Date).getTime()/1e3)+""},raw=function(args){var keys=Object.keys(args);keys=keys.sort();var newArgs={};keys.forEach(function(key){newArgs[key.toLowerCase()]=args[key]});var string="";for(var k in newArgs)string+="&"+k+"="+newArgs[k];return string=string.substr(1)},nonceStr=createNonceStr(),timestamp=createTimestamp(),weixinSdkConfig=function(){$scope.ticket=getWxSdkToken().ticket;var ret={jsapi_ticket:getWxSdkToken().ticket,nonceStr:nonceStr,timestamp:timestamp,url:$location.absUrl().split("#")[0]},string=raw(ret),signature=signSha1(string),config={appId:easybuy.weixinAppId,timestamp:timestamp,nonceStr:nonceStr,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"],signature:signature};$(document).ready(function(){wx.config(config),wx.ready(function(){wx.onMenuShareTimeline({title:desc,link:link+"1",imgUrl:imgUrl,success:function(){$scope.fadeOutShare();{var tokenInfo=getToken();"platform=all&token="+tokenInfo.token}},cancel:function(){}}),wx.onMenuShareAppMessage({title:title,desc:desc,link:link+"2",imgUrl:imgUrl,type:"link",dataUrl:"",success:function(){},cancel:function(){}})}),wx.error(function(res){alertWarning(JSON.stringify(res))})})};if(easybuy.isWechat)if(!getWxSdkToken()||getWxSdkToken()&&!getWxSdkToken().ticket){var data="platform=all";httpRequest.APIPOST("/wx/data?platform=all",null,{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){var data=result.result;setWxSdkToken({accessToken:data.access_token,ticket:data.ticket}),weixinSdkConfig()}else alert(result.msg)})}else weixinSdkConfig();if($scope.goTo=function(index){for(var g=[],i=0;i<$scope.products.length;i++)g.push($scope.products[i].goodsId);index<=g.length&&($scope.isApp?window.location.href=easybuy.appActivity+"?action=1&goodId="+g[index-1]:$location.path("/product/"+g[index-1]+"/1"))},$scope.more=function(){$scope.isApp?window.location.href=easybuy.appActivity+"?action=5":$location.path("/products")},$scope.shareToFriends=function(){if($scope.isApp)return void(window.location.href=easybuy.appActivity+"?action=3&shareTitle="+title+"&shareText="+desc+"&shareUrl="+link+"&shareImageUrl="+imgUrl+"&title=购轻松台湾！");if(easybuy.isWechat){var tokenInfo=getToken();tokenInfo&&tokenInfo.token&&tokenInfo.openId?$scope.fadeInShare():$location.path("/wechatOauth/activity-activityDetail")}else{var arrButton=["确定"];openDialog("请在微信内打开并分享到朋友圈","",arrButton,null,function(r){})}},$scope.shareSuccess=function(){},$scope.back=function(){$location.path("/products")},$scope.fadeOutShare=function(){$("#shareHint").fadeOut()},$scope.fadeInShare=function(){$("#shareHint").fadeIn()},$location.search()&&$location.search().activityId){var actId="";actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId;var data="platform=all&activityId="+actId;httpRequest.APIPOST("/activity/detail",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){if(result&&result.code==statusCode.Success){if($scope.activityInfo=result.result,null==result.result)return void alertExt("该活动已结束，更多精彩活动尽在首页！",function(){$location.path("/"),$scope.$apply($location)});var act=$scope.activityInfo.activity;act.url||(act.url=""),link=act.url.indexOf("?")>0?act.url+"&activityId="+act.id+"&source=3&sharedTo=":act.url+"?activityId="+act.id+"&source=3&sharedTo=",imgUrl=act.img,title=act.name,desc=act.desc,$scope.products=[],$scope.activityInfo&&$scope.activityInfo.fullGiveGoodsList&&($scope.products=$scope.activityInfo.fullGiveGoodsList)}else alert(result.msg)})}if($location.search()&&$location.search().sharedTo&&$location.search().source){var actId=($location.search(),""),channel=$location.search().sharedTo||1;channel instanceof Array&&(channel=1);{var platform=$location.search().source||"all";$location.search().pageType||""}platform=1==platform?"android":2==platform?"ios":"all",actId=$location.search().activityId instanceof Array?$location.search().activityId[0]:$location.search().activityId;var token="";getToken()&&(token="&token="+getToken().token);var data="activityId="+actId+"&channel="+channel+"&platform="+platform+token;httpRequest.APIPOST("/activity/clickLog",dataStringify(data),{"content-type":"application/x-www-form-urlencoded"}).then(function(result){result&&result.code==statusCode.Success})}}),app.register.controller("taxFreeStoreController",function($rootScope,$scope,httpRequest,dataStringify,signSha1,analytics,$location){$scope.isShowNavbar=!1,$scope.isApp=isApp($location),$scope.isShowNavbar=$scope.isApp?!1:!0,$scope.back=function(){history.back()}});